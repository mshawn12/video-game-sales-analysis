<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Video Game Analysis</title>
  <script src="https://cdn.plot.ly/plotly-2.20.0.min.js"></script>
  <script src="https://d3js.org/d3.v5.min.js"></script>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
</head>

<body>

  <div class="container">
    <div class="row">
      <div class="col-md-12 jumbotron text-center">
        <img src="https://github.com/mshawn12/video-game-sales-analysis/blob/mydashboard/images/dashboard-banner.png?raw=true" alt="Video Game Banner" width="100%">
        <!-- <h1>Video Game Genre Analysis</h1>
        <p>Use the interactive charts below to explore the dataset</p> -->
      </div>
    </div>

    <div id="navigation">
        <button><a href="/dashboard">All Genres</a></button>&nbsp;&nbsp;&nbsp;<button><a href="/actiondashboard">Action</a></button>&nbsp;&nbsp;&nbsp;<button><a href="/adventuredashboard">Adventure</a></button>&nbsp;&nbsp;&nbsp;<button><a href="/fightingdashboard">Fighting</a></button>&nbsp;&nbsp;&nbsp;<button><a href="/fpsdashboard">FPS</a></button>&nbsp;&nbsp;&nbsp;<button><a href="/miscdashboard">Misc</a></button>&nbsp;&nbsp;&nbsp;<button><a href="/platformdashboard">Platform</a></button>&nbsp;&nbsp;&nbsp;<button><a href="/puzzledashboard">Puzzle</a></button>&nbsp;&nbsp;&nbsp;<button><a href="/racingdashboard">Racing</a></button>&nbsp;&nbsp;&nbsp;<button><a href="/roleplayingdashboard">Role-Playing</a></button>&nbsp;&nbsp;&nbsp;<button><a href="/simulationdashboard">Simulation</a></button>&nbsp;&nbsp;&nbsp;<button><a href="/sportsdashboard">Sports</a></button>&nbsp;&nbsp;&nbsp;<button><a href="/strategydashboard">Strategy</a></button>
    </div>
    <br/>
    <br/>
    
    <!-- <div class="row">
      <div class="col-md-2">
        <div class="well">
          <h5>Select Genre:</h5>
          <select id="selDataset" onchange="optionChanged(this.value)"></select>
        </div>
        <div class="panel panel-primary">
          <div class="panel-heading">
            <h3 class="panel-title">Video Game Info</h3>
          </div>
          <div id="sample-metadata" class="panel-body"></div>
        </div>
      </div> -->
      <!-- <div class="col-md-5">
        <div id="bar"></div>
      </div>
      <div class="col-md-5">
        <div id="gauge"></div>
      </div>
    </div>
    <div class="row">
      <div class="col-md-12">
        <div id="bubble"></div>
      </div>
    </div>
  </div> -->

  <div id="plotscores"></div>
  <br/>
  <div id="plot"></div>
  <br/>
  <div id="plotregions"></div>
  <br/>
  <div id="plot2"></div>
  <br/>
  <div id="plot3"></div>
  <br/>
  <div id="plot4"></div>
  <br/>
  <div id="bubble"></div>
  <div id="gauge"></div>
 <script>
    // var data = {{games|tojson|safe}};
    // var data = {{games}}
    // var data = "http://127.0.0.1:5000/api/v1.0/completedata"
//     console.log(data);
//    d3.json("http://127.0.0.1:5000/api/v1.0/completedata").then((gamedata)=>{
//     console.log(gamedata)
//    })


//     var trace1 = {
//     x: data.criticscore,
//     y: data.globalsales,
//     mode: 'markers',
//     marker: {
//         size: [40, 60, 80, 100]
//     }
//     };

//     var data = [trace1];

//     var layout = {
//     title: 'Marker Size',
//     showlegend: false,
//     height: 600,
//     width: 600
//     };

//     Plotly.newPlot('plot', data, layout);

//     console.log(data) -->

    // let selector = d3.select("#selDataset");
    

    // //call API
    // d3.json("http://127.0.0.1:5000/api/v1.0/genres").then((data) =>{
    //     // console.log(data.names);
    //     let gamedata = data;

    //     //loop through and generate option links from dataset
    //     for(let index = 0; index < gamedata.length; index++){
    //         console.log(gamedata[index].genre)
    //         selector.append("option").text(gamedata[index].genre).property("value", gamedata[index].genre);
            
    //     }
    //     let gameOne = gamedata[0];

        //generateCharts(gameOne);
        // generateMetadata(sampleOne);

    // })
    

</script>

<script>
//     function optionChanged(newGenre){
//     // generateCharts(newSample);
//     // generateMetadata(newSample);
   
// }
    d3.json("http://127.0.0.1:5000/api/v1.0/actiondashboard").then((data) =>{
        // console.log(data.names);
        let gamedata = data;
let genres = []
let totalglobalsales = []
let totalnasales = []
let totaleusales = []
let totaljpsales = []
let names = []
let developers = []
let publishers = []
let criticscores = []
let userscores = []
let ratings = []
let gamecount = names.length

        //loop through and generate option links from dataset
        console.log(gamedata)
        for(let index = 0; index < gamedata.length; index++){
            totalglobalsales.push(gamedata[index].globalsales)
            genres.push(gamedata[index].genre)
            names.push(gamedata[index].name)
            developers.push(gamedata[index].developer)
            publishers.push(gamedata[index].publisher)
            ratings.push(gamedata[index].rating)
            criticscores.push(gamedata[index].criticscore)
            userscores.push(gamedata[index].userscore)
            totalnasales.push(gamedata[index].nasales)
            totaleusales.push(gamedata[index].eusales)
            totaljpsales.push(gamedata[index].jpsales)

        }
        
       
        // console.log(totalglobalsales)
        // console.log(genres)
        // console.log(names)
        // console.log(developers)
        // console.log(publishers)
        // console.log(criticscores)
        // console.log(userscores)
        // console.log(ratings)


// Chart scores
var tracecritic = {
            x: genres,
            y: criticscores,
            type: 'bar',
            name: 'Critic Review Scores',
            marker: {
                color: 'rgb(142,124,195)'
            }

        }   

var traceuser = {
            x: genres,
            y: userscores,
            type: 'bar',
            name: 'User Review Scores',
            marker: {
                color: 'rgb(8,48,107)'
            }

        }   

        var datascores = [tracecritic,traceuser];

        
        var layoutscores = {
            title: "Critic Score (Out of 100) | User Score (Out of 10)"            
             
        }

        Plotly.newPlot('plotscores', datascores, layoutscores);

// Chart 1
        var trace = {
            x: names,
            y: totalglobalsales,
            type: 'bar'

        }   
        var data = [trace];
        
        var layout = {
            title: "Global Sales by Game"            
             
        }

        Plotly.newPlot('plot', data, layout);

// Chart 2
var tracena = {
            x: genres,
            y: totalnasales,
            type: 'bar',
            name: 'NA Sales'

        }   

var traceeu = {
            x: genres,
            y: totaleusales,
            type: 'bar',
            name: 'EU Sales'

        }   

var tracejp = {
            x: genres,
            y: totaljpsales,
            type: 'bar',
            name: 'JP Sales'

        }   
        var dataregions = [tracena,traceeu,tracejp];

        
        var layoutregions = {
            title: "Regional Sales by Genre"            
             
        }

        Plotly.newPlot('plotregions', dataregions, layoutregions);


// Chart 3
        var trace2 = {
            x: publishers,
            y: criticscores,
            type: 'bar'

        }   
        var data2 = [trace2];
        
        var layout2 = {
            title: "Critic Score by Publisher"
             
        }

        Plotly.newPlot('plot2', data2, layout2)

        var trace3 = {
            x: developers,
            y: criticscores,
            type: 'bar'

        }   
        var data3 = [trace3];
        
        var layout3 = {
            title: "Critic Score by Developer"
             
        }

        Plotly.newPlot('plot3', data3, layout3)

        var trace4 = {
            x: ratings,
            y: totalglobalsales,
            type: 'bar'

        }   
        var data4 = [trace4];
        
        var layout4 = {
            title: "Global Sales by Rating"
             
        }

        Plotly.newPlot('plot4', data4, layout4)
        
        let bubbleLayout = {
            title: "",
            margin: {t: 0},
            hovermode: "closest",
            xaxis: {title: "Critic Score vs. Global Sales"},
            margin: {t: 30}

        };

        let bubbleData = [
            {
                x: criticscores,
                y: totalglobalsales,
                text: genres,
                mode: "markers",
                marker: {
                    size: totalglobalsales,
                    color: genres,
                    colorscale: "Bluered"        
                }
            }

        ]
        // Generate bubble chart
        Plotly.newPlot("bubble", bubbleData, bubbleLayout);

    });

</script>


<script>

 
 
</script>

  <script src="https://d3js.org/d3.v5.min.js"></script>
  <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
  <script src="./static/js/app.js"></script>
  <script src="./static/js/gauge.js"></script>


</body>

</html>
